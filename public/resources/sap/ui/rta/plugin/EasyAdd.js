/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/additionalElements/AdditionalElementsPlugin","sap/ui/dt/OverlayRegistry","sap/m/Button"],function(e,t,a){"use strict";var s=e.extend("sap.ui.rta.plugin.EasyAdd",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});s.prototype.registerElementOverlay=function(a){var s=a.getElement();if(s.getMetadata().getName()==="sap.uxap.ObjectPageSection"&&this.hasStableId(a)){a.addStyleClass("sapUiRtaPersAdd");s.addStyleClass("sapUiRtaMarginBottom")}else if(s.getMetadata().getName()==="sap.uxap.ObjectPageLayout"&&this.hasStableId(a)){a.addStyleClass("sapUiRtaPersAddTop");s.getDomRef().querySelectorAll("[id*='sectionsContainer']").forEach(function(e){e.classList.add("sapUiRtaPaddingTop")})}var i=function(e,t,a){var s;var i="sections";if(e){s=t.getDesignTimeMetadata().getName().plural}else{s=t.getDesignTimeMetadata().getAggregation(i).childNames.plural()}this.clearCachedElements();this.showAvailableElements(e,i,[t],a,s)}.bind(this);var r=function(e,a,s,r,n){var o=function(e){var a=t.getOverlay(e.currentTarget.id.replace("-AddButton",""));i(s,a,n);e.stopPropagation()};var l=typeof r==="function"?r():r;this._addButton(e,o,a,l,s)}.bind(this);if(a.hasStyleClass("sapUiRtaPersAdd")){var n=Array.from(a.getDomRef().querySelectorAll(":scope > .sapUiRtaPersAddIconOuter"));var o=a.hasStyleClass("sapUiRtaPersAdd")&&n.length===0;if(o){r(a,a.getDomRef(),true,a.getDesignTimeMetadata().getName().singular)}}else if(a.hasStyleClass("sapUiRtaPersAddTop")){var n=Array.from(a.getAggregationOverlay("sections").getDomRef().querySelectorAll(":scope > .sapUiRtaPersAddIconOuter"));if(n.length===0){var l=a.getAggregationOverlay("sections").getDomRef();r(a,l,false,a.getDesignTimeMetadata().getAggregation("sections").childNames.singular,0)}}e.prototype.registerElementOverlay.apply(this,arguments)};s.prototype.deregisterElementOverlay=function(t){var a=t.getElement();if(t._oAddButton){t._oAddButton.destroy()}if(a.getMetadata().getName()==="sap.uxap.ObjectPageSection"){t.removeStyleClass("sapUiRtaPersAdd");a.removeStyleClass("sapUiRtaMarginBottom")}else if(a.getMetadata().getName()==="sap.uxap.ObjectPageLayout"){t.removeStyleClass("sapUiRtaPersAddTop");a.getDomRef().querySelectorAll("[id*='sectionsContainer']").forEach(function(e){e.classList.remove("sapUiRtaPaddingTop")})}e.prototype.deregisterElementOverlay.apply(this,arguments)};s.prototype._isEditable=function(t){return e.prototype._isEditable.apply(this,arguments).then(function(e){if(t._oAddButton){var a=t.hasStyleClass("sapUiRtaPersAddTop");var s=a?"asChild":"asSibling";t._oAddButton.setEnabled(e[s]);if(a){var i=t.getElement();i.attachEventOnce("onAfterRenderingDOMReady",function(){i.getDomRef().querySelectorAll("[id*='sectionsContainer']").forEach(function(e){e.classList.add("sapUiRtaPaddingTop")})})}}return e})};s.prototype._addButton=function(e,s,i,r,n){var o=e.getEditableByPlugins().indexOf(this._retrievePluginName(n))>-1;var l=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");var d=e.getId()+"-AddButton";var g=document.createElement("div");g.classList.add("sapUiRtaPersAddIconOuter");g.setAttribute("draggable","true");g.setAttribute("tabindex",-1);e._oAddButton=new a(d,{text:l.getText("CTX_ADD_ELEMENTS",r),icon:"sap-icon://add",enabled:o}).placeAt(g).attachBrowserEvent("click",s).attachBrowserEvent("tap",s);i.append(g);g.addEventListener("mouseover",function(e){e.stopPropagation();var a=e.fromElement?t.getOverlay(e.fromElement.id):null;if(a&&a.getMetadata().getName()==="sap.ui.dt.ElementOverlay"){var s=a.getParentElementOverlay();s.removeStyleClass("sapUiRtaOverlayHover")}});g.addEventListener("mouseleave",function(e){e.stopPropagation();var a=e.toElement?t.getOverlay(e.toElement.id):null;if(a&&a.getMetadata().getName()==="sap.ui.dt.ElementOverlay"){var s=a.getParentElementOverlay();if(s.getMovable()){s.addStyleClass("sapUiRtaOverlayHover")}}});g.addEventListener("click",function(e){e.stopPropagation()});g.addEventListener("contextmenu",function(e){e.stopPropagation();e.preventDefault()});g.addEventListener("dragstart",function(e){e.stopPropagation();e.preventDefault()})};return s});
//# sourceMappingURL=EasyAdd.js.map