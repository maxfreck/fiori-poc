/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/Plugin","sap/ui/dt/Util","sap/ui/fl/Utils","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/write/api/LocalResetAPI","sap/ui/rta/command/CompositeCommand","sap/m/MessageToast","sap/ui/dt/OverlayRegistry"],function(e,t,a,r,n,i,o,s){"use strict";function l(e,t){return t?e.getCurrentVariantReference(t):""}var u=e.extend("sap.ui.rta.plugin.LocalReset",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});u.prototype._isEditable=function(e){var t=this.getAction(e);return!!t};u.prototype.isEnabled=function(e){if(e.length!==1){return false}var t=e[0];var i=t.getElement();var o=this.getAction(t);if(!o){return false}var u=true;if(typeof o.isEnabled!=="undefined"){if(typeof o.isEnabled==="function"){u=o.isEnabled(i)}else{u=o.isEnabled}}var p=o.changeOnRelevantContainer?t.getRelevantContainer():i;var d=s.getOverlay(p);var g=a.getAppComponentForControl(p);var c=g.getModel(r.getVariantModelName());var m=l(c,this.getVariantManagementReference(d));return u&&n.isResetEnabled(p,{layer:this.getCommandFactory().getFlexSettings().layer,currentVariant:m})};u.prototype.getMenuItems=function(e){return this._getMenuItems(e,{pluginId:"CTX_LOCAL_RESET",rank:61,icon:"sap-icon://reset"})};u.prototype.getActionName=function(){return"localReset"};u.prototype.handler=function(e){var n=e[0];var s=n.getElement();var u=n.getDesignTimeMetadata();var p=this.getVariantManagementReference(n);var d=a.getAppComponentForControl(s);var g=d.getModel(r.getVariantModelName());var c=l(g,p);var m=!!c;var f=m?d.byId(p)||sap.ui.getCore().byId(p):undefined;var v=this.getCommandFactory();var y=new i;return Promise.all([v.getCommandFor(s,"localReset",{currentVariant:c},u,p),m&&v.getCommandFor(f,"save",{model:g},u,p)].filter(Boolean)).then(function(e){e.forEach(function(e){y.addCommand(e)});this.fireElementModified({command:y});if(m){var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta").getText("MSG_LOCAL_RESET_VARIANT_SAVE");o.show(t,{duration:5e3})}}.bind(this)).catch(function(e){throw t.propagateError(e,"LocalReset#handler","Error occurred during handler execution","sap.ui.rta.plugin")})};return u});
//# sourceMappingURL=LocalReset.js.map