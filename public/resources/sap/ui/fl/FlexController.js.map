{"version":3,"file":"FlexController.js","names":["sap","ui","define","ChangeHandlerStorage","Utils","Layer","ChangePersistenceFactory","Versions","Applier","Reverter","URLHandler","FlexObjectFactory","States","ControlVariantApplyAPI","JsControlTreeModifier","XmlTreeModifier","Component","Log","revertChangesAndUpdateVariantModel","oComponent","bSkipUrlUpdate","aChanges","Promise","resolve","then","length","reverse","revertMultipleChanges","appComponent","modifier","flexController","this","bind","oModel","getModel","getVariantModelName","forEach","oChange","sVariantReference","getVariantReference","removeChange","update","parameters","updateURL","updateHashEntry","model","FlexController","sComponentName","_oChangePersistence","undefined","_sComponentName","getChangePersistenceForComponent","getComponentName","prototype","setVariantSwitchPromise","oPromise","_oVariantSwitchPromise","waitForVariantSwitch","createBaseChange","oChangeSpecificData","oAppComponent","Error","reference","packageName","createUIChange","variantReference","setVariantReference","_createChange","oControl","sControlType","controlType","getControlType","getChangeHandler","getChangeType","getLayer","oChangeHandler","completeChangeContent","view","getViewForControl","JSON","stringify","setState","LifecycleState","NEW","catch","oError","reject","createChangeWithExtensionPointSelector","mExtensionPointReference","oView","getAppComponentForControl","selector","name","viewSelector","getSelector","getId","createChangeWithControlSelector","FakePromise","sControlId","id","Object","assign","addChange","_ignoreOnce","addPreparedChange","setQueuedForApply","deleteChange","applyChange","mPropertyBag","applyChangeOnControl","oReturn","success","oException","error","checkDependencies","mDependencies","mChanges","aRelevantChanges","bResult","canChangePotentiallyBeApplied","push","sDependencyKey","aDependentChanges","dependencies","i","n","oDependentChange","getChangeFromChangesMap","aSelectors","getDependentControlSelectorList","some","oSelector","bySelector","waitForChangesToBeApplied","aPromises","map","mSelector","_waitForChangesToBeApplied","all","filterChanges","isCurrentProcessFinished","changeTypes","includes","getCore","byId","mChangesMap","getChangesMapForComponent","aChangesForControl","aNotYetProcessedChanges","filter","indexOf","concat","addChangeProcessingPromises","_removeOtherLayerChanges","sLayer","bRemoveOtherLayerChanges","aLayersToReset","values","sLayerToCheck","removeDirtyChanges","saveAll","bSkipUpdateCache","bDraft","bCondenseAnyLayer","sParentVersion","aDraftFilenames","oVersionModel","getVersionsModel","normalizeReference","layer","CUSTOMER","getProperty","saveDirtyChanges","oResult","response","vChangeDefinition","Array","isArray","change","fileName","onAllChangesSaved","draftFilenames","processXmlView","oViewComponent","get","componentId","getChangesForView","applyAllChangesForXMLView","handleXMLApplyError","getComponentChanges","bInvalidateCache","getChangesForComponent","getOpenDependentChangesForControl","resetChanges","sGenerator","aSelectorIds","aChangeTypes","vLayer","applyVariantChanges","reduce","oPreviousPromise","_addRunTimeCreatedChangeAndUpdateDependencies","saveSequenceOfDirtyChanges","aDirtyChanges"],"sources":["FlexController-dbg.js"],"mappings":"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"}