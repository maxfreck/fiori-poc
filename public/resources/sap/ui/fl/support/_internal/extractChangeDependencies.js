/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/thirdparty/jquery"],function(e,n,jQuery){"use strict";function a(e){var a;var i=document.querySelector(".sapUiComponentContainer");i=Array.isArray(i)?i:[i];i.some(function(i){var t=sap.ui.getCore().byId(i.id);var s=t&&t.getComponentInstance();if(s&&n.getFlexReferenceForControl(s)===e){a=s;return true}});return a}function i(n,i){var s=a(i.sComponentName);for(var r in n._mChangesEntries){var o=n._mChangesEntries[r];i.mChangesEntries[r]={mDefinition:o.getDefinition(),aControlsDependencies:[],aDependencies:[]};if(o._aDependentSelectorList){o._aDependentSelectorList.forEach(function(n){var a={bPresent:!!e.bySelector(n,s),aAppliedChanges:[],aFailedChangesJs:[],aFailedChangesXml:[],aNotApplicableChanges:[]};i.mControlData[n.id]=a})}}t(n,i)}function t(e,n){for(var a in e._mChangesInitial.mDependencies){var i=e._mChangesInitial.mDependencies[a];n.mChangesEntries[a].aControlsDependencies=i.controlsDependencies;n.mChangesEntries[a].aDependencies=i.dependencies}}function s(e,n){jQuery.each(e._mVariantsChanges,function(e,a){n.mVariantsChanges[e]={mDefinition:a._oDefinition}})}function r(e,n,a,i,t){if(t){a[i]=t;a[i].map(function(a){if(!(a in e[n])){e[n].push(a)}})}}function o(e,n){var a=e.getCustomData();var i=[];a.forEach(function(e){var a=e.getKey();if(a.startsWith(n)){i.push(a.replace(n,""))}});return i}function l(e,n){for(var a in e._mChanges.mChanges){var i={bPresent:false,aAppliedChanges:[],aFailedChangesJs:[],aFailedChangesXml:[],aNotApplicableChanges:[]};var t=sap.ui.getCore().byId(a);if(t){i.bPresent=true;r(n,"aAppliedChanges",i,"aAppliedChanges",o(t,"sap.ui.fl.appliedChanges."));r(n,"aFailedChanges",i,"aFailedChangesJs",o(t,"sap.ui.fl.failedChanges.js."));r(n,"aFailedChanges",i,"aFailedChangesXml",o(t,"sap.ui.fl.failedChanges.xml."));r(n,"aNotApplicableChanges",i,"aNotApplicableChanges",o(t,"sap.ui.fl.notApplicableChanges."))}n.mControlData[a]=i}}return function(e){if(!e){return}var n={sVersion:"1",bIsInvestigationExport:true,mControlData:{},aAppliedChanges:[],aFailedChanges:[],aNotApplicableChanges:[],mChangesEntries:{},mVariantsChanges:{},sComponentName:e._mComponent.name};i(e,n);s(e,n);l(e,n);return n}});
//# sourceMappingURL=extractChangeDependencies.js.map